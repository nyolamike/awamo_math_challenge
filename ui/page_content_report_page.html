<div class="content-wrapper content-height page_content page_content_hidden " id="page_content_report_page">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1 class="inline_h1">
            <i class="fa fa-bar-chart orange" style="color:#f5a802;"></i>
            Reports
            <small>structered data insights</small>
        </h1>

        <div data-for="report_page_departures" class="report_sub_menu app_sub_menu_item  active_sub_module">
            <a href="#">
                <i class="fa   fa-level-up "></i>
                <span>Departures</span>
                <i class="fa  fa-chevron-right pull-right chev cutout2"></i>
            </a>
        </div>
        <div data-for="report_page_arrivals" class="report_sub_menu app_sub_menu_item">
            <a href="#">
                <i class="fa  fa-level-down"></i>
                <span>Arrivals</span>
                <i class="fa  fa-chevron-right pull-right chev cutout2"></i>
            </a>
        </div>
        <div data-for="report_page_bookings" class="report_sub_menu app_sub_menu_item">
            <a href="#">
                <i class="fa  fa-bolt"></i>
                <span>Over Bookings</span>
                <i class="fa  fa-chevron-right pull-right chev cutout2"></i>
            </a>
        </div>
        <div data-for="report_page_sales" class="report_sub_menu app_sub_menu_item">
            <a href="#">
                <i class="fa  fa-line-chart"></i>
                <span>Room Sales</span>
                <i class="fa  fa-chevron-right pull-right chev cutout2"></i>
            </a>
        </div>
    </section>

    <!-- Main content -->
    <section class="content">
        <div class="report_page report_page_active " id="report_page_departures">
            <div class="row">
                <div class="col-lg-12">
                    <!-- DIRECT CHAT SUCCESS -->
                    <div class="box box-warning direct-chat direct-chat-success tall-box-report">
                        <div class="box-header with-border">
                            <h6 class="box-title" style="color:rgb(78, 78, 78)">*A listing of bookings that are scheduled to checkout today and tommorrow</h6>
                            <button id="departure-report-download-pdf" class="btn btn-sm btn-success pull-right">
                                <i class="fa fa-download"></i>
                                download pdf
                            </button>
                            <button id="departure-report-download-xlsx" class="btn btn-sm btn-success pull-right" style="margin-right: 5px;">
                                <i class="fa fa-download"></i>
                                download excell
                            </button>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div id="departure-report-table" style="margin-top: 0px; margin-bottom: 0px;"></div>
                        </div>
                        <!-- /.box-body -->
                        <div id="depature_report_overlay" class="overlay overlay-hidden">
                            <i class="fa fa-refresh fa-spin"></i>
                        </div>
                    </div>
                    <!--/.direct-chat -->
                </div>
            </div>
        </div>
        <div class="report_page" id="report_page_arrivals">
            <div class="row">
                <div class="col-lg-12">
                    <!-- DIRECT CHAT SUCCESS -->
                    <div class="box box-warning direct-chat direct-chat-success tall-box-report">
                        <div class="box-header with-border">
                            <h6 class="box-title" style="color:rgb(78, 78, 78)">*A listing of bookings that are scheduled to checkin today and tommorrow</h6>
                            <button id="arrival-report-download-pdf" class="btn btn-sm btn-success pull-right">
                                <i class="fa fa-download"></i>
                                download pdf
                            </button>
                            <button id="arrival-report-download-xlsx" class="btn btn-sm btn-success pull-right" style="margin-right: 5px;">
                                <i class="fa fa-download"></i>
                                download excell
                            </button>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div id="arrival-report-table" style="margin-top: 0px; margin-bottom: 0px;"></div>
                        </div>
                        <!-- /.box-body -->
                        <div id="arrival_report_overlay" class="overlay overlay-hidden">
                            <i class="fa fa-refresh fa-spin"></i>
                        </div>
                    </div>
                    <!--/.direct-chat -->
                </div>
            </div>
        </div>
        <div class="report_page" id="report_page_bookings">
            <div class="row">
                <div class="col-lg-12">
                    <!-- DIRECT CHAT SUCCESS -->
                    <div class="box box-warning direct-chat direct-chat-success tall-box-report">
                        <div class="box-header with-border">
                            <h6 class="box-title" style="color:rgb(78, 78, 78)">*A listing of bookings that have over stayed past checkout time </h6>
                            <button id="overbookings-report-download-pdf" class="btn btn-sm btn-success pull-right">
                                <i class="fa fa-download"></i>
                                download pdf
                            </button>
                            <button id="overbookings-report-download-xlsx" class="btn btn-sm btn-success pull-right" style="margin-right: 5px;">
                                <i class="fa fa-download"></i>
                                download excell
                            </button>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div id="overbookings-report-table" style="margin-top: 0px; margin-bottom: 0px;"></div>
                        </div>
                        <!-- /.box-body -->
                        <div id="overbookings_report_overlay" class="overlay overlay-hidden">
                            <i class="fa fa-refresh fa-spin"></i>
                        </div>
                    </div>
                    <!--/.direct-chat -->
                </div>
            </div>
        </div>
        <div class="report_page" id="report_page_sales">
            <div class="row">
                <div class="col-lg-12">
                    <!-- DIRECT CHAT SUCCESS -->
                    <div class="box box-warning direct-chat direct-chat-success tall-box-report">
                        <div class="box-header with-border">
                            <div class="row">
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-4">
                                            <div class="input-group input-group-sm">
                                                <div class="input-group-addon">
                                                    From:
                                                </div>
                                                <input type="text" class="form-control input-sm datepicker" id="sales_report_from_date_input" />
                                                <div class="input-group-addon">
                                                    <i class="fa fa-calendar"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-4">
                                            <div class="input-group input-group-sm ">
                                                <div class="input-group-addon">
                                                    To:
                                                </div>
                                                <input type="text" class="form-control input-sm datepicker" id="sales_report_to_date_input" />
                                                <div class="input-group-addon">
                                                    <i class="fa fa-calendar"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-4">
                                            <div class="input-group input-group-sm">
                                                <button type="button" id="sales_report_refresh_submit_btn" class="btn btn-sm btn-success pull-right app_action_item disabled_action app_action_booking_r1">
                                                    <i class="fa fa-refresh"></i>
                                                    refresh
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    &nbsp;&nbsp;
                                    <button id="sales-report-download-pdf" class="btn btn-sm btn-success pull-right">
                                        <i class="fa fa-download"></i>
                                        download pdf
                                    </button>
                                    <button id="sales-report-download-xlsx" class="btn btn-sm btn-success pull-right" style="margin-right: 5px;">
                                        <i class="fa fa-download"></i>
                                        download excell
                                    </button>
                                </div>
                            </div>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div id="sales-report-table" style="margin-top: 0px; margin-bottom: 0px;"></div>
                        </div>
                        <!-- /.box-body -->
                        <div id="sales_report_overlay" class="overlay overlay-hidden">
                            <i class="fa fa-refresh fa-spin"></i>
                        </div>
                    </div>
                    <!--/.direct-chat -->
                </div>
            </div>
        </div>
    </section>
    <!-- /.content -->
</div>

<script>
    app.pages.master_page.pages.report = {
        id: "report",
        showDepatureLoader: function () {
            $("#depature_report_overlay").removeClass("overlay-hidden");//show loader
        },
        hideDepatureLoader: function () {
            $("#depature_report_overlay").addClass("overlay-hidden");//hide loader
        },
        loadDepartureReport: function () {

            var todayMorningString = app.getTodayDateStr(new Date()) + " 00:00:00 am";
            var todayMorningDate = new Date(todayMorningString);
            var todayMorningTime = todayMorningDate.getTime();
            var todayEndString = app.getTodayDateStr(new Date()) + " 11:59:00 pm";
            var todayEndDate = new Date(todayEndString);
            var todayEndTime = todayEndDate.getTime();

            var tomoroMorningDate = new Date(todayMorningTime + (24 * 60 * 60 * 1000));
            var tomoroMorningTime = tomoroMorningDate.getTime();
            var tomoroEndString = app.getTodayDateStr(tomoroMorningDate) + " 11:59:00 pm";
            var tomoroEndDate = new Date(tomoroEndString);
            var tomoroEndTime = tomoroEndDate.getTime();

            //the heckout for these bookings must fall between today morning
            //and tommorrow night
            var nec = {
                bookings: {
                    booked_rooms: {
                        booked_room_bills: {},
                        room: {
                            room_category: {}
                        },
                        guests: {
                            client: {}
                        },
                        booked_room_payments: {}
                    },
                    _w: [
                        [
                            ["checkout_time", "gte", todayMorningTime / 1000],
                            "AND",
                            ["checkout_time", "lte", tomoroEndTime / 1000]
                        ]
                    ]
                }
            };
            app.pages.master_page.pages.report.showDepatureLoader();
            bee.get(nec, function (hny) {
                app.pages.master_page.pages.report.hideDepatureLoader();
                if (hny._errors.length > 0) {
                    app.showErrors(hny._errors);
                } else {
                    //process the data
                    console.log("departure report", hny);
                    /*
                    {title:"#", field:"num", width:50, align:"left"},
                    {title:"Booking No.", field:"booking_id", width:200, align:"center"},
                    {title:"Name", field:"name", align:"left"},
                    {title:"Room", field:"room", align:"left" },
                    {title:"Category", field:"category", align:"center"},
                    {title:"When", field:"when", align:"center"},
                    {title:"Balance", field:"balance", align:"right"}
                    */
                    var reportData = [];
                    for (var i = 0; i < hny.bookings.length; i++) {
                        var booking = hny.bookings[i];
                        //when
                        var when = "";
                        var checkoutTime = booking.checkout_time * 1000;
                        if (checkoutTime >= todayMorningTime && checkoutTime <= todayEndTime) {
                            when = "today";
                        } else if (checkoutTime >= tomoroMorningTime && checkoutTime <= tomoroEndTime) {
                            when = "tommorrow";
                        } else {
                            when = "unknown";
                        }
                        var balance = 0;
                        var bill = 0;
                        var payments = 0;
                        for (var j = 0; j < booking.booked_rooms.length; j++) {
                            var booked_room = booking.booked_rooms[j];
                            for (var k = 0; k < booked_room.booked_room_bills.length; k++) {
                                var billx = booked_room.booked_room_bills[k];
                                bill = bill + parseFloat(billx.sub_total);
                            }
                            for (var k = 0; k < booked_room.booked_room_payments.length; k++) {
                                var pay = booked_room.booked_room_payments[k];
                                payments = payments + parseFloat(pay.amount);
                            }
                        }
                        balance = bill - payments;

                        for (var j = 0; j < booking.booked_rooms.length; j++) {
                            var booked_room = booking.booked_rooms[j];
                            for (var k = 0; k < booked_room.guests.length; k++) {
                                var guest = booked_room.guests[k];
                                var row = {};
                                //num
                                row["num"] = reportData.length + 1;
                                //booking_id
                                row["booking_id"] = booking.id;
                                //Name
                                row["name"] = guest.client.name;
                                //room
                                row["room"] = booked_room.room.number;
                                //category
                                row["category"] = booked_room.room.room_category.name;
                                //when
                                row["when"] = when;
                                //Balance
                                row["balance"] = balance;
                                reportData.push(row);
                            }
                        }
                    }
                    $("#departure-report-table").tabulator("clearData");
                    $("#departure-report-table").tabulator("setData", reportData);
                }
            });
        },
        showArrivalLoader: function () {
            $("#arrival_report_overlay").removeClass("overlay-hidden");//show loader
        },
        hideArrivalLoader: function () {
            $("#arrival_report_overlay").addClass("overlay-hidden");//hide loader
        },
        loadArrivalReport: function () {
            var todayMorningString = app.getTodayDateStr(new Date()) + " 00:00:00 am";
            var todayMorningDate = new Date(todayMorningString);
            var todayMorningTime = todayMorningDate.getTime();
            var todayEndString = app.getTodayDateStr(new Date()) + " 11:59:00 pm";
            var todayEndDate = new Date(todayEndString);
            var todayEndTime = todayEndDate.getTime();

            var tomoroMorningDate = new Date(todayMorningTime + (24 * 60 * 60 * 1000));
            var tomoroMorningTime = tomoroMorningDate.getTime();
            var tomoroEndString = app.getTodayDateStr(tomoroMorningDate) + " 11:59:00 pm";
            var tomoroEndDate = new Date(tomoroEndString);
            var tomoroEndTime = tomoroEndDate.getTime();

            //the checkin for these bookings must fall between today morning
            //and tommorrow night
            var nec = {
                bookings: {
                    booked_rooms: {
                        booked_room_bills: {},
                        room: {
                            room_category: {}
                        },
                        guests: {
                            client: {}
                        },
                        booked_room_payments: {}
                    },
                    _w: [
                        [
                            ["checkin_time", "gte", todayMorningTime / 1000],
                            "AND",
                            ["checkin_time", "lte", tomoroEndTime / 1000]
                        ]
                    ]
                }
            };
            app.pages.master_page.pages.report.showArrivalLoader();
            bee.get(nec, function (hny) {
                app.pages.master_page.pages.report.hideArrivalLoader();
                if (hny._errors.length > 0) {
                    app.showErrors(hny._errors);
                } else {
                    //process the data
                    console.log("arrival report", hny);
                    /*
                    {title:"#", field:"num", width:50, align:"left"},
                    {title:"Booking No.", field:"booking_id", width:200, align:"center"},
                    {title:"Name", field:"name", align:"left"},
                    {title:"Room", field:"room", align:"left" },
                    {title:"Category", field:"category", align:"center"},
                    {title:"When", field:"when", align:"center"},
                    {title:"Balance", field:"balance", align:"right"}
                    */
                    var reportData = [];
                    for (var i = 0; i < hny.bookings.length; i++) {
                        var booking = hny.bookings[i];
                        //when
                        var when = "";
                        var checkin_time = booking.checkin_time * 1000;
                        if (checkin_time >= todayMorningTime && checkin_time <= todayEndTime) {
                            when = "today";
                        } else if (checkin_time >= tomoroMorningTime && checkin_time <= tomoroEndTime) {
                            when = "tommorrow";
                        } else {
                            when = "unknown";
                        }
                        var balance = 0;
                        for (var j = 0; j < booking.booked_rooms.length; j++) {
                            var booked_room = booking.booked_rooms[j];
                            balance = balance + (parseFloat(booked_room.room.room_category.price) * parseFloat(booking.number_of_nights));
                        }

                        for (var j = 0; j < booking.booked_rooms.length; j++) {
                            var booked_room = booking.booked_rooms[j];
                            var row = {};
                            //num
                            row["num"] = reportData.length + 1;
                            //booking_id
                            row["booking_id"] = booking.id;
                            //Name
                            row["name"] = booking.name;
                            //room
                            row["room"] = booked_room.room.number;
                            //category
                            row["category"] = booked_room.room.room_category.name;
                            //when
                            row["when"] = when;
                            //Balance
                            row["balance"] = balance * -1;
                            reportData.push(row);
                        }
                    }
                    $("#arrival-report-table").tabulator("clearData");
                    $("#arrival-report-table").tabulator("setData", reportData);
                }
            });
        },
        showOverBookingLoader: function () {
            $("#overbookings_report_overlay").removeClass("overlay-hidden");//show loader
        },
        hideOverBookingLoader: function () {
            $("#overbookings_report_overlay").addClass("overlay-hidden");//hide loader
        },
        loadOverBookingReport: function () {
            var checkoutDateString = app.getTodayDateStr(new Date()) + " " + app.config.checkout_time;
            var checkoutDate = new Date(checkoutDateString);
            var checkoutDateTime = checkoutDate.getTime();
            console.log("checkoutDateTime", checkoutDateTime, checkoutDateString);

            //the checkoutDateTime is greater than booking checkout yet booking is 
            //on status checkedin
            var nec = {
                bookings: {
                    booked_rooms: {
                        booked_room_bills: {},
                        room: {
                            room_category: {}
                        },
                        guests: {
                            client: {}
                        },
                        booked_room_payments: {}
                    },
                    _w: [
                        [
                            ["checkout_time", "lte", checkoutDateTime / 1000],
                            "AND",
                            ["status", "e", "checkedin"]
                        ]
                    ]
                }
            };
            app.pages.master_page.pages.report.showOverBookingLoader();
            bee.get(nec, function (hny) {
                app.pages.master_page.pages.report.hideOverBookingLoader();
                if (hny._errors.length > 0) {
                    app.showErrors(hny._errors);
                } else {
                    //process the data
                    console.log("overbooked report", hny);
                    /*
                    {title:"#", field:"num", width:50, align:"left"},
                    {title:"Booking No.", field:"booking_id", width:200, align:"center"},
                    {title:"Name", field:"name", align:"left"},
                    {title:"Room", field:"room", align:"left" },
                    {title:"Category", field:"category", align:"center"},
                    {title:"When", field:"when", align:"center"},
                    {title:"Balance", field:"balance", align:"right"}
                    */
                    var reportData = [];
                    for (var i = 0; i < hny.bookings.length; i++) {
                        var booking = hny.bookings[i];
                        //when
                        var diff = "";
                        var g = checkoutDateTime - parseInt(booking.checkout_time * 1000);
                        //console.log("g",g,checkoutDateTime,booking.checkout_time);
                        diff = (g / (24 * 60 * 60 * 1000)) + " hrs";

                        var balance = 0;
                        for (var j = 0; j < booking.booked_rooms.length; j++) {
                            var booked_room = booking.booked_rooms[j];
                            balance = balance + (parseFloat(booked_room.room.room_category.price) * parseFloat(booking.number_of_nights));
                        }

                        for (var j = 0; j < booking.booked_rooms.length; j++) {
                            var booked_room = booking.booked_rooms[j];
                            for (var k = 0; k < booked_room.guests.length; k++) {
                                var guest = booked_room.guests[k];
                                var row = {};
                                //num
                                row["num"] = reportData.length + 1;
                                //booking_id
                                row["booking_id"] = booking.id;
                                //Name
                                row["name"] = guest.client.name;
                                //room
                                row["room"] = booked_room.room.number;
                                //category
                                row["category"] = booked_room.room.room_category.name;
                                //diff
                                row["diff"] = diff;
                                //Balance
                                row["balance"] = balance;
                                reportData.push(row);
                            }
                        }
                    }
                    $("#overbookings-report-table").tabulator("clearData");
                    $("#overbookings-report-table").tabulator("setData", reportData);
                }
            });
        },
        showSalesLoader: function () {
            $("#sales_report_overlay").removeClass("overlay-hidden");//show loader
        },
        hideSalesLoader: function () {
            $("#sales_report_overlay").addClass("overlay-hidden");//hide loader
        },
        loadSalesReport: function () {
            var fromDateString = $("#sales_report_from_date_input").val();
            var toDateString = $("#sales_report_to_date_input").val();
            if(fromDateString == null || fromDateString.length == 0){
                //thirty days back
                var nowDate = new Date();
                var todayString = app.getTodayDateStr(nowDate);
                var thirtyDaysSeconds = 24 * 60 * 60 * 30 * 1000;
                var thirtyDayTime = nowDate.getTime() - thirtyDaysSeconds;
                nowDate.setTime(thirtyDayTime);
                fromDateString = app.getTodayDateStr(nowDate);
                $("#sales_report_from_date_input").val(fromDateString);
                //make the to date to be today
                toDateString = todayString;
                $("#sales_report_to_date_input").val(toDateString);
            }else if(toDateString == null || toDateString.length == 0){
                //thirty days from the from date
                var fromDate = new Date(fromDateString);
                var thirtyDaysSeconds = 24 * 60 * 60 * 30 * 1000;
                var thirtyDayTime = fromDate.getTime() + thirtyDaysSeconds;
                fromDate.setTime(thirtyDayTime);
                toDateString = app.getTodayDateStr(fromDate);
                $("#sales_report_to_date_input").val(toDateString);
            }
            console.log("fromDateString, toDateString",fromDateString, toDateString);
            var fromDate = new Date(fromDateString);
            var toDate = new Date(toDateString);
            var fromTime = fromDate.getTime();
            var toTime = toDate.getTime();

            var a = "id guest_id booked_room_id booking_id room_id payment_type amount amount_given";
            a = a + " change_given document_number transaction_id payment_status notes time_inserted ";
            var nec = {
                booked_room_payments: {
                    _a: a,
                    guest:{
                        client:{}
                    },
                    booking:{},
                    _w: [
                        [
                            ["time_inserted", "gte", fromTime / 1000],
                            "AND",
                            ["time_inserted", "lte", toTime / 1000]
                        ]
                    ]
                }
            };
            app.pages.master_page.pages.report.showSalesLoader();
            bee.get(nec, function (hny) {
                app.pages.master_page.pages.report.hideSalesLoader();
                if (hny._errors.length > 0) {
                    app.showErrors(hny._errors);
                } else {
                    //process the data
                    console.log("sales report", hny);
                    
                    var reportData = [];
                    var total = 0;
                    for (var i = 0; i < hny.booked_room_payments.length; i++) {
                        var payment = hny.booked_room_payments[i];
                        var row = {};
                        //num
                        row["num"] = reportData.length + 1;
                        //booking_id
                        row["booking_id"] = payment.booking.id;
                        //booker
                        row["booker"] = payment.booking.name;
                        //Paid by
                        row["name"] = payment.guest.client.name;
                        //amount
                        row["amount"] = parseFloat(payment.amount);
                        total = total + parseFloat(payment.amount);
                        reportData.push(row);
                    }

                    //total
                    var row = {};
                    //num
                    row["num"] = "";
                    //booking_id
                    row["booking_id"] = "";
                    //booker
                    row["booker"] = "";
                    //Paid by
                    row["name"] = "TOTAL";
                    //amount
                    row["amount"] = total;
                    reportData.push(row);
                    $("#sales-report-table").tabulator("clearData");
                    $("#sales-report-table").tabulator("setData", reportData);
                }
            });
        },
        load: function () {
            $(".report_sub_menu").on("click", function (event) {
                //make all report_sub_menu deactive
                $(".report_sub_menu").removeClass("active_sub_module");
                //make this one the only active submemu
                $(this).addClass("active_sub_module");
                //hide all other report pages
                $(".report_page").removeClass("report_page_active");
                //make this one the active page
                var pg = $(this).attr("data-for");
                $("#" + pg).addClass("report_page_active");
                if (pg == "report_page_departures") {
                    app.pages.master_page.pages.report.loadDepartureReport();
                } else if (pg == "report_page_arrivals") {
                    app.pages.master_page.pages.report.loadArrivalReport();
                } else if (pg == "report_page_bookings") {
                    app.pages.master_page.pages.report.loadOverBookingReport();
                } else if (pg == "report_page_sales") {
                    app.pages.master_page.pages.report.loadSalesReport();
                }
            });
            //departure
            $("#departure-report-table").tabulator({
                height: "100%",
                layout: "fitDataFill",
                columns: [
                    { title: "no.", field: "num", width: 50, align: "left" },
                    { title: "#", field: "booking_id", width: 50, align: "center" },
                    { title: "Name", field: "name", align: "left" },
                    { title: "Room", field: "room", align: "left" },
                    { title: "Category", field: "category", align: "center" },
                    { title: "When", field: "when", align: "center" },
                    { title: "Balance", field: "balance", align: "right" }
                ]
            });
            //trigger download of data.xlsx file
            $("#departure-report-download-xlsx").on("click", function (event) {
                $("#departure-report-table").tabulator("download", "xlsx", "data.xlsx", { sheetName: "Departure " + (new Date()).toDateString() });
            });
            //trigger download of data.pdf file
            $("#departure-report-download-pdf").click(function () {
                $("#departure-report-table").tabulator("download", "pdf", "data.pdf", {
                    orientation: "portrait", //set page orientation to portrait
                    title: "Depature " + (new Date()).toDateString(), //add title to report
                });
            });
            app.pages.master_page.pages.report.loadDepartureReport();
            //arrival
            $("#arrival-report-table").tabulator({
                height: "100%",
                layout: "fitDataFill",
                columns: [
                    { title: "no.", field: "num", width: 50, align: "left" },
                    { title: "#", field: "booking_id", width: 50, align: "center" },
                    { title: "Name", field: "name", align: "left" },
                    { title: "Room", field: "room", align: "left" },
                    { title: "Category", field: "category", align: "center" },
                    { title: "When", field: "when", align: "center" },
                    { title: "Balance", field: "balance", align: "right" }
                ]
            });
            //trigger download of data.xlsx file
            $("#arrival-report-download-xlsx").on("click", function (event) {
                $("#arrival-report-table").tabulator("download", "xlsx", "data.xlsx", { sheetName: "Arrivals " + (new Date()).toDateString() });
            });
            //trigger download of data.pdf file
            $("#arrival-report-download-pdf").on("click", function () {
                $("#arrival-report-table").tabulator("download", "pdf", "data.pdf", {
                    orientation: "portrait", //set page orientation to portrait
                    title: "Arrivals " + (new Date()).toDateString() //add title to report
                });
            });
            //overbooking
            $("#overbookings-report-table").tabulator({
                height: "100%",
                layout: "fitDataFill",
                columns: [
                    { title: "no.", field: "num", width: 50, align: "left" },
                    { title: "#", field: "booking_id", width: 50, align: "center" },
                    { title: "Name", field: "name", align: "left" },
                    { title: "Room", field: "room", align: "left" },
                    { title: "Category", field: "category", align: "center" },
                    { title: "Diff", field: "diff", align: "center" },
                    { title: "Balance", field: "balance", align: "right" }
                ]
            });
            //trigger download of data.xlsx file
            $("#overbookings-report-download-xlsx").on("click", function (event) {
                $("#overbookings-report-table").tabulator("download", "xlsx", "data.xlsx", { sheetName: "Overbookings " + (new Date()).toDateString() });
            });
            //trigger download of data.pdf file
            $("#overbookings-report-download-pdf").on("click", function () {
                $("#overbookings-report-table").tabulator("download", "pdf", "data.pdf", {
                    orientation: "portrait", //set page orientation to portrait
                    title: "Overbookings " + (new Date()).toDateString() //add title to report
                });
            });
        
            //sales report
            $("#sales-report-table").tabulator({
                height: "100%",
                layout: "fitDataFill",
                columns: [
                    { title: "no.", field: "num", width: 50, align: "left" },
                    { title: "#", field: "booking_id", width: 50, align: "center" },
                    { title: "Booked by", field: "booker", align: "left" },
                    { title: "Paid by", field: "name", align: "left" },
                    { title: "Amount", field: "amount", align: "right" }
                ]
            });
            //trigger download of data.xlsx file
            $("#sales-report-download-xlsx").on("click", function (event) {
                $("#sales-report-table").tabulator("download", "xlsx", "data.xlsx", { sheetName: "Overbookings " + (new Date()).toDateString() });
            });
            //trigger download of data.pdf file
            $("#sales-report-download-pdf").on("click", function () {
                $("#sales-report-table").tabulator("download", "pdf", "data.pdf", {
                    orientation: "portrait", //set page orientation to portrait
                    title: "Overbookings " + (new Date()).toDateString() //add title to report
                });
            });
            $("#sales_report_refresh_submit_btn").on("click",function(event){
                app.pages.master_page.pages.report.loadSalesReport();
            });
        
        }
    }
</script>